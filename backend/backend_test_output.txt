============================= test session starts ==============================
platform linux -- Python 3.10.12, pytest-8.3.5, pluggy-1.5.0 -- /home/johnj/CascadeProjects/optin-manager/.venv/bin/python
cachedir: .pytest_cache
rootdir: /home/johnj/CascadeProjects/optin-manager/backend
plugins: anyio-4.9.0, cov-6.1.1
collecting ... collected 117 items

tests/test_api_auth.py::test_login_success PASSED                        [  0%]
tests/test_api_auth.py::test_login_invalid_credentials PASSED            [  1%]
tests/test_api_auth.py::test_reset_password PASSED                       [  2%]
tests/test_api_auth.py::test_change_password PASSED                      [  3%]
tests/test_api_auth.py::test_verify_code PASSED                          [  4%]
tests/test_api_auth_user.py::test_create_auth_user PASSED                [  5%]
tests/test_api_auth_user.py::test_get_auth_user PASSED                   [  5%]
tests/test_api_auth_user.py::test_update_auth_user PASSED                [  6%]
tests/test_api_auth_user.py::test_delete_auth_user PASSED                [  7%]
tests/test_api_consent.py::test_create_consent PASSED                    [  8%]
tests/test_api_consent.py::test_read_consent PASSED                      [  9%]
tests/test_api_consent.py::test_update_consent PASSED                    [ 10%]
tests/test_api_consent.py::test_delete_consent PASSED                    [ 11%]
tests/test_api_contact.py::test_create_contact PASSED                    [ 11%]
tests/test_api_contact.py::test_read_contact PASSED                      [ 12%]
tests/test_api_contact.py::test_update_contact PASSED                    [ 13%]
tests/test_api_contact.py::test_delete_contact PASSED                    [ 14%]
tests/test_api_contact_additional.py::test_list_contacts_with_admin_auth PASSED [ 15%]
tests/test_api_contact_additional.py::test_list_contacts_with_parameters PASSED [ 16%]
tests/test_api_contact_additional.py::test_get_contact_not_found PASSED  [ 17%]
tests/test_api_customization.py::test_get_customization_empty PASSED     [ 17%]
tests/test_api_customization.py::test_update_colors PASSED               [ 18%]
tests/test_api_customization.py::test_upload_logo PASSED                 [ 19%]
tests/test_api_customization.py::test_get_customization_with_logo_and_colors PASSED [ 20%]
tests/test_api_customization_additional.py::test_save_customization_complete PASSED [ 21%]
tests/test_api_customization_additional.py::test_save_customization_invalid_logo_type PASSED [ 22%]
tests/test_api_dashboard.py::test_dashboard_stats_empty_db PASSED        [ 23%]
tests/test_api_dashboard.py::test_dashboard_stats_with_data PASSED       [ 23%]
tests/test_api_dashboard.py::test_dashboard_stats_time_period PASSED     [ 24%]
tests/test_api_message.py::test_send_message_opted_in PASSED             [ 25%]
tests/test_api_message.py::test_send_message_not_opted_in PASSED         [ 26%]
tests/test_api_message_crud.py::test_create_message PASSED               [ 27%]
tests/test_api_message_crud.py::test_read_message PASSED                 [ 28%]
tests/test_api_message_crud.py::test_update_message PASSED               [ 29%]
tests/test_api_message_crud.py::test_delete_message PASSED               [ 29%]
tests/test_api_message_template.py::test_create_message_template PASSED  [ 30%]
tests/test_api_message_template.py::test_read_message_template PASSED    [ 31%]
tests/test_api_message_template.py::test_update_message_template PASSED  [ 32%]
tests/test_api_message_template.py::test_delete_message_template PASSED  [ 33%]
tests/test_api_optin.py::test_create_and_get_optin PASSED                [ 34%]
tests/test_api_optin.py::test_update_optin PASSED                        [ 35%]
tests/test_api_optin.py::test_optin_status_management PASSED             [ 35%]
tests/test_api_preferences.py::test_send_verification_code SKIPPED (...) [ 36%]
tests/test_api_preferences.py::test_verify_code SKIPPED (SMS provide...) [ 37%]
tests/test_api_preferences.py::test_get_preferences_with_token SKIPPED   [ 38%]
tests/test_api_preferences.py::test_get_preferences_with_contact_param SKIPPED [ 39%]
tests/test_api_preferences.py::test_update_preferences SKIPPED (SMS ...) [ 40%]
tests/test_api_preferences_additional.py::test_get_preferences_wrong_scope PASSED [ 41%]
tests/test_api_preferences_additional.py::test_request_with_expired_token PASSED [ 41%]
tests/test_api_preferences_additional.py::test_invalid_token_format PASSED [ 42%]
tests/test_api_preferences_additional.py::test_bulk_update_with_product_ids PASSED [ 43%]
tests/test_api_preferences_coverage.py::test_send_code_with_email PASSED [ 44%]
tests/test_api_preferences_coverage.py::test_get_preferences_admin_access PASSED [ 45%]
tests/test_api_preferences_coverage.py::test_get_preferences_with_multiple_products PASSED [ 46%]
tests/test_api_preferences_coverage.py::test_bulk_preference_update PASSED [ 47%]
tests/test_api_preferences_edge_cases.py::test_send_code_missing_contact PASSED [ 47%]
tests/test_api_preferences_edge_cases.py::test_send_code_invalid_contact_type PASSED [ 48%]
tests/test_api_preferences_edge_cases.py::test_send_code_invalid_phone_format PASSED [ 49%]
tests/test_api_preferences_edge_cases.py::test_send_code_invalid_email_format PASSED [ 50%]
tests/test_api_preferences_edge_cases.py::test_send_code_authorization_required PASSED [ 51%]
tests/test_api_preferences_edge_cases.py::test_verify_code_not_found PASSED [ 52%]
tests/test_api_preferences_edge_cases.py::test_verify_code_expired PASSED [ 52%]
tests/test_api_preferences_edge_cases.py::test_verify_code_already_used PASSED [ 53%]
tests/test_api_preferences_edge_cases.py::test_verify_code_wrong_contact PASSED [ 54%]
tests/test_api_preferences_edge_cases.py::test_verify_code_missing_fields PASSED [ 55%]
tests/test_api_preferences_edge_cases.py::test_get_preferences_unauthorized PASSED [ 56%]
tests/test_api_preferences_edge_cases.py::test_get_preferences_invalid_token PASSED [ 57%]
tests/test_api_preferences_edge_cases.py::test_get_preferences_no_contact_id PASSED [ 58%]
tests/test_api_preferences_edge_cases.py::test_update_preferences_no_auth PASSED [ 58%]
tests/test_api_preferences_edge_cases.py::test_update_preferences_invalid_json PASSED [ 59%]
tests/test_api_preferences_edge_cases.py::test_update_preferences_basic PASSED [ 60%]
tests/test_api_preferences_edge_cases.py::test_get_preferences_with_admin_token PASSED [ 61%]
tests/test_api_preferences_mocked.py::test_send_verification_code PASSED [ 62%]
tests/test_api_preferences_mocked.py::test_verify_code PASSED            [ 63%]
tests/test_api_preferences_mocked.py::test_get_preferences_with_token PASSED [ 64%]
tests/test_api_preferences_mocked.py::test_get_preferences_with_contact_param PASSED [ 64%]
tests/test_api_preferences_mocked.py::test_update_preferences PASSED     [ 65%]
tests/test_api_provider_secrets.py::test_set_provider_secret_email PASSED [ 66%]
tests/test_api_provider_secrets.py::test_set_provider_secret_sms PASSED  [ 67%]
tests/test_api_provider_secrets.py::test_set_provider_secret_invalid_type PASSED [ 68%]
tests/test_api_provider_secrets.py::test_get_secrets_status PASSED       [ 69%]
tests/test_api_provider_secrets.py::test_delete_provider_secret PASSED   [ 70%]
tests/test_api_provider_secrets.py::test_provider_connection_dev_mode PASSED [ 70%]
tests/test_api_provider_secrets.py::test_provider_connection_no_credentials PASSED [ 71%]
tests/test_api_provider_secrets.py::test_provider_connection_invalid_type PASSED [ 72%]
tests/test_api_provider_secrets.py::test_provider_connection_email_aws_ses PASSED [ 73%]
tests/test_api_user.py::test_create_contact PASSED                       [ 74%]
tests/test_api_user.py::test_read_contact PASSED                         [ 75%]
tests/test_api_user.py::test_update_contact PASSED                       [ 76%]
tests/test_api_user.py::test_delete_contact PASSED                       [ 76%]
tests/test_api_verification_code.py::test_create_verification_code PASSED [ 77%]
tests/test_api_verification_code.py::test_read_verification_code PASSED  [ 78%]
tests/test_api_verification_code.py::test_update_verification_code PASSED [ 79%]
tests/test_api_verification_code.py::test_delete_verification_code PASSED [ 80%]
tests/test_crud_contact.py::TestContactCrud::test_get_contact PASSED     [ 81%]
tests/test_crud_contact.py::TestContactCrud::test_get_contact_by_value PASSED [ 82%]
tests/test_crud_contact.py::TestContactCrud::test_create_contact PASSED  [ 82%]
tests/test_crud_contact.py::TestContactCrud::test_update_contact PASSED  [ 83%]
tests/test_crud_contact.py::TestContactCrud::test_delete_contact PASSED  [ 84%]
tests/test_crud_contact.py::TestContactCrud::test_list_contacts PASSED   [ 85%]
tests/test_crud_contact.py::TestContactCrud::test_list_contacts_with_filters PASSED [ 86%]
tests/test_crud_contact.py::TestContactCrud::test_get_masked_contact_value SKIPPED [ 87%]
tests/test_crud_customization.py::test_get_customization_empty PASSED    [ 88%]
tests/test_crud_customization.py::test_get_customization_existing PASSED [ 88%]
tests/test_crud_customization.py::test_set_logo_path_new PASSED          [ 89%]
tests/test_crud_customization.py::test_set_logo_path_existing PASSED     [ 90%]
tests/test_crud_customization.py::test_set_colors_new PASSED             [ 91%]
tests/test_crud_customization.py::test_set_colors_existing PASSED        [ 92%]
tests/test_main.py::test_health_endpoint PASSED                          [ 93%]
tests/test_main.py::test_favicon_endpoint PASSED                         [ 94%]
tests/test_main.py::test_docs_endpoint_redirect PASSED                   [ 94%]
tests/test_main.py::test_redoc_endpoint PASSED                           [ 95%]
tests/test_main.py::test_static_files PASSED                             [ 96%]
tests/test_main.py::test_validation_error_handler PASSED                 [ 97%]
tests/test_utils_phone.py::TestPhoneUtils::test_normalize_phone_number PASSED [ 98%]
tests/test_utils_phone.py::TestPhoneUtils::test_is_valid_phone_number PASSED [ 99%]
tests/test_utils_phone.py::TestPhoneUtils::test_mask_phone_number PASSED [100%]

======================== 111 passed, 6 skipped in 8.50s ========================
